# load zgen
source "${HOME}/.zgen/zgen.zsh"

# if the init scipt doesn't exist
if ! zgen saved; then
  echo "Creating a zgen save"

  zgen oh-my-zsh

  # plugins
  zgen oh-my-zsh plugins/git
  zgen oh-my-zsh plugins/command-not-found
  zgen oh-my-zsh plugins/history
  zgen load zsh-users/zsh-syntax-highlighting

  # bulk load
  zgen loadall <<EOPLUGINS
  zsh-users/zsh-history-substring-search
EOPLUGINS
  # ^ can't indent this EOPLUGINS

  # completions
  zgen load zsh-users/zsh-completions src

  # theme
  zgen oh-my-zsh themes/clean

  # save all to init script
  zgen save
fi

# Handle dup path in tmux for Mac OS X
# http://superuser.com/questions/544989/does-tmux-sort-the-path-variable/583502#583502
if [[ `uname` == "Darwin" ]]; then
  if [ -f /etc/profile ]; then
    PATH=""
    source /etc/profile
  fi
fi

if [[ -n $SSH_CONNECTION ]]; then
  export EDITOR='vim'
else
  export EDITOR='nvim'
fi

# Allow [ or ] whereever you want
unsetopt nomatch

# Go
export GOPATH="$HOME/code/go"

# PATH setup
export PATH="$HOME/.rbenv/bin:/usr/local/sbin:$HOME/.nvm/versions/node/v5.2.0/bin:$PATH"
export PATH="$PATH:$HOME/bin:$HOME/.fzf/bin:$HOME/.multirust/toolchains/stable/cargo/bin:/usr/local/opt/go/libexec/bin:$GOPATH/bin"

# Load rbenv
eval "$(rbenv init - )"

# Load FZF
[ -f ~/.fzf/shell/key-bindings.zsh ] && source ~/.fzf/shell/key-bindings.zsh
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# Sourcing of other zsh files
source $HOME/.dotfiles/files/zsh/aliases
source $HOME/.dotfiles/files/zsh/z
source /usr/local/share/zsh/site-functions

# autoload -U compinit && compinit

if [[ `uname` == "Darwin" ]]; then
  source ~/.zshrc.mac
fi

if [[ `uname` == "Linux" ]]; then
  source ~/.zshrc.linux
fi
